import domlib from"https://cdn.jsdelivr.net/gh/SaulDoesCode/kurshok/dist/domlib.js";Array.prototype.randomize=function(){let t,e=[],o=this,i=o.length;for(;e.length!=i;)e.push(o[t=Math.floor(Math.random()*o.length)]),o.splice(t,1);return o.splice(0,o.length,...e),o},domlib.run((async t=>{const{queryAsync:e,query:o,render:i,domfn:a}=domlib,{div:n,article:s,p:r,br:l,section:d,span:c,header:p}=a,m=domlib.emitter({toasts:new Set}),h=(t,e)=>{for(const i of[...(t=o(t)).children].randomize())e&&!e(i)||(i.remove(),t.appendChild(i))},u=m.ftxt=async t=>(await(await fetch(t)).text()).trim(),g=m.cdnRoot="https://cdn.jsdelivr.net/gh/SaulDoesCode/",b=g+"resources/",x=(await u(b+"expressions.txt")).split("\n").map((t=>t.trim())).filter((t=>""!=t)).randomize(),y=t=>e=>e.classList.contains(t),f=t=>h(z,y("idea")),k=t=>h(v,y("exp")),w=t=>{return(e=h,(...t)=>(...o)=>(e(...t),e(...o)))(".doodle-links")(".links",(t=>"A"==t.tagName));var e},v=d.expressions({$pre:"main",ondblclick(){k()}},p("expressions"),n.spacer,x.map((t=>r.exp(t)))),z=d.short_ideas({$pre:"main",ondblclick(){f()}},n.spacer,p("short ideas"),l,n.spacer),A=(await u(b+"short-ideas.txt")).split(".").map((t=>t.trim())).filter((t=>t.length>0)).randomize().map((t=>s.idea(((t,e,[o,i])=>[t(o),e(i)])(p,c,t.split(":"))))),C="experimental",j=t=>"#"!=t[0]?"#"+t:t,S=t=>{t.remove(),m.toasts.delete(t),clearTimeout(t.to)};document.onpointerdown=async t=>{const e=t.target;e.hasAttribute("copyable")&&navigator.clipboard&&window.isSecureContext&&(await navigator.clipboard.writeText(e.textContent.trim()),m.emit.toast("Copied to clipboard"))},document.oncontextmenu=t=>{let e=t.target.getAttribute("audio");if(null!=e){t.stopPropagation(),t.preventDefault();(m[e]||(m[e]=new Audio(e))).play(),m.emit.toast("Playing book title sound...")}},m.on.toast((t=>m.toasts.add(n.toast({$:"body",css:{top:`calc(1vh + 1.5cm * ${m.toasts.size})`,zIndex:0},onclick(t,e){S(e)}},t,(t=>{t.to=setTimeout((e=>S(t)),5500)}))))),(await e(".breathing-circle")).onpointerdown=t=>{return e=C,location.hash=j(e);var e},i(A,z),m.emit.toast("loaded; pressing r randomizes things"),m.emit.toast("right-clicking on a book plays its title audio"),w(),m.once.xpm((async()=>(await import((m.isLH="c"==location.hostname[2]?"./":g+"kurshok/dist/")+"experimental.js")).default(m,domlib))),(onhashchange=t=>j(C)===location.hash&&m.emit.xpm())(),onkeyup=t=>((t,e,...o)=>t===e&&(e=null,o.forEach((t=>e=t(e))),e))(t.key,"r",f,k,w)}));