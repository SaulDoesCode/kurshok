import domlib from"/js/domlib.min.js";const app={initDropdown:o=>{let e;o.isDropdownOpen=()=>o.classList.contains("open"),app.whenHoveringOver(o,e=>{o.isDropdownOpen()||o.toggleDropdown(!0)}),o.toggleDropdown=(n=!o.isDropdownOpen())=>n?(app.openDropdown&&app.openDropdown.toggleDropdown(!1),app.openDropdown=o,o.classList.add("open"),o.clickawayHandle.on(),e=app.whenNotHoveringOver(o,e=>{clearTimeout(o.closeTimeout),o.closeTimeout=setTimeout(()=>{o.isDropdownOpen()&&(o.toggleDropdown(!1),e.off())},1500),app.whenHoveringOver(o,n=>{clearTimeout(o.closeTimeout),n.off(),e.on()})}),o):(o.classList.remove("open"),o.clickawayHandle.off(),e&&e.off(),app.openDropdown=null,o),o.clickawayHandle=domlib.on.click(document.body,e=>{e.target==o||o.contains(e.target)||o.toggleDropdown(!1)}).off()},NotHoveringOverHandlers:[],HoveringOverHandlers:[],whenNotHoveringOver:(o,e)=>{e.el=o;const n=domlib.on.pointerleave(o,o=>{e.notified||(e.notified=!0,e(e))}).off();return e.off=()=>(e.isOn&&(e.isOn=!1,app.NotHoveringOverHandlers.splice(e.i,1),n.off()),e),e.on=()=>(e.isOn||(e.isOn=!0,e.i=app.NotHoveringOverHandlers.push(e)-1,n.on()),e),e.on()},whenHoveringOver:(o,e)=>(e.el=o,e.off=()=>(app.HoveringOverHandlers.splice(e.i,1),e.isOn=!1,e),e.on=()=>(e.isOn||(e.isOn=!0,e.i=app.HoveringOverHandlers.push(e)-1),e),e.on()),isHoveringOver:o=>app.hoveringOn.includes(o),hoverElementChanged:o=>{for(const o of app.NotHoveringOverHandlers)app.isHoveringOver(o.el)?o.notified=!1:o.notified||(o.notified=!0,o(o));for(const o of app.HoveringOverHandlers)app.isHoveringOver(o.el)?o.notified||(o.notified=!0,o(o)):o.notified=!1}};domlib.run(()=>{app.compareHoverPath=o=>{app.lastHoveringOn?o.path[0]!=app.lastHoveringOn[0]&&(app.lastHoveringOn=app.hoveringOn,app.hoverElementChanged(app.hoveringOn=o.path)):app.hoverElementChanged(app.lastHoveringOn=app.hoveringOn=o.path)},document.body.addEventListener("pointerover",app.compareHoverPath,{passive:!0}),document.body.addEventListener("pointerenter",app.compareHoverPath,{passive:!0}),(app.dropdowns=[...document.querySelectorAll(".dropdown")]).forEach(app.initDropdown)}),app.writs=[];{const o=(o,e)=>fetch(o,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),e=(e,n,t=["musings"],i={})=>new Promise((a,r)=>{const p={title:e,raw_content:n.trim(),tags:t,kind:"post",public:!0,viewable_by:[]};Object.assign(p,i),o("/writ",p).then(o=>o.json()).then(o=>o.ok?a(o.data):r(o))}),n=()=>e("Second Writ","\n** ain't this some shiiit.. **    \nfirst writ of many that came before\n".trim(),["testing","development"]),t=({parent_id:e="post:0:1",writ_id:n="post:0:1",raw_content:t="This is a comment, and it's even unique nogal, see: "+Math.round(100*Math.random())+Math.round(100*Math.random())+".",author_only:i=!1}={})=>new Promise((a,r)=>{o("/comment",{parent_id:e,writ_id:n,raw_content:t,author_only:i}).then(o=>{o.ok&&o.json().then(a).catch(o=>{r(new Error("no good, the json was invalid"))})}).catch(o=>{r(new Error("no good, it didn't work"))})}),i=async(o={},e)=>{null==o.path&&(o.path="post:0:0/"),null==o.page&&(o.page=1);const n=JSON.stringify(o);if("number"!=typeof e)return await fetch("/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:n});for(let o=e;o-- >0;)await fetch("/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:n})},a=async(o,e,n=e)=>0==o--||a(o,(await t({parent_id:e,writ_id:n})).data.id,n);(async(o=10,e)=>{const t=await n(),r=[];for(;o-- >0;)r.push(a(9,t.id,t.id));await Promise.all(r),await i({path:t.id+"/"},e)})()}
//# sourceMappingURL=main.min.js.map